<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>centWave Parameters • msbrowser</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="centWave Parameters">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-78685833-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-78685833-4');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msbrowser</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">App Function</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    centWave Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pars.html">Description of Parameters</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tkimhofer/msbrowser">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>centWave Parameters</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tkimhofer/msbrowser/blob/master/vignettes/pars.Rmd"><code>vignettes/pars.Rmd</code></a></small>
      <div class="hidden name"><code>pars.Rmd</code></div>

    </div>

    
    
<p><em>ppm, peakwidth, snthresh, prefilter, mzCenterFun, integrate, mzdiff, fitgauss, scanrange, noise.</em></p>
<p> </p>
<p>All centWave parameters require fine-tuning for each assay type and mass analyser. The following provides a short description of each parameter value and it’s relevance in the <em>centWave</em> algorithm.</p>
<p> </p>
<table class="table">
<colgroup>
<col width="32%">
<col width="38%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
<th align="center">Pre-adjusted value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="#ppm-allowed-signal-deviation-in-mz-dimension">ppm</a></td>
<td>Allowed signal deviation in m/z dimension</td>
<td align="center">25</td>
</tr>
<tr class="even">
<td><a href="#peakwidth-range-of-peak-elution-times">peakwidth</a></td>
<td>Range of peak elution times (in seconds)</td>
<td align="center">20-50 s</td>
</tr>
<tr class="odd">
<td><a href="#snthresh-threshold-of-signal-to-noise-ratio">snthresh</a></td>
<td>Threshold signal to noise ratio</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td><a href="#prefilter-number-of-data-points-k-exceeding-a-certain-intensity-threshold-i">prefilter</a></td>
<td>Peak definition: Number of data points (<em>n</em>) exceeding a certain intensity threshold (<em>I</em>)</td>
<td align="center">
<em>k</em>=3, <em>I</em>=100</td>
</tr>
<tr class="odd">
<td><a href="#mzdiff-accepted-closeness-of-two-signals-in-mz-dimension">mzdiff</a></td>
<td>Accepted closeness of two signals in m/z dimension</td>
<td align="center">-0.001</td>
</tr>
<tr class="even">
<td><a href="#noise-intensity-cut-off-values-below-are-not-considered">noise</a></td>
<td>Intensity cut-off, values below are considered as instrument noise</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td><a href="#mzcenterfun-mz-summary-statistic-of-a-peak">mzCenterFun</a></td>
<td>Function to calculate the m/z center of a chromatographic peak</td>
<td align="center">weighted Mean (wMean)</td>
</tr>
<tr class="even">
<td><a href="#integrate-integration-method-for-peak-quantifiaction">integrate</a></td>
<td>Integration method for peak quantification: 1 - Mexican hat filtered data, 2 - real data</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td><a href="#integrate-peak-parametrisation-using-gaussiand-distribution">fitgauss</a></td>
<td>Peak parameterisation using Gaussian distribution</td>
<td align="center">FALSE</td>
</tr>
<tr class="even">
<td><a href="#scanrange-perform-peak-picking-in-a-specific-scan-range">scanrange</a></td>
<td>Perform peak picking in a scan range interval</td>
<td align="center">numeric(0)</td>
</tr>
</tbody>
</table>
<p> </p>
<p> </p>
<p> </p>
<div id="ppm-allowed-signal-deviation-in-mz-dimension" class="section level2">
<h2 class="hasAnchor">
<a href="#ppm-allowed-signal-deviation-in-mz-dimension" class="anchor"></a><strong><em><span style="color:red">ppm</span></em></strong>: Allowed signal deviation in m/z dimension</h2>
<p>This <em>centWave</em> parameter <em>ppm</em> specifies the tolerance in m/z values for defining a signal in m/z dimensions. This parameter is closely related to the mass accuracy of the mass spectrometer, which is traditionally expressed in parts per million (ppm).</p>
<p align="center">
<img src="../imgs/pars1/ppm_formula.png"></p>
<p>Higher <em>ppm</em> values allow more m/z value variations and lead to detection of a higher number of potential peaks - increasing false positives. Lower values can lead to missing out on many signals, since the measured mass values differ from the true mass more than expected.</p>
<p>The illustration below shows a peak picking example using the same LC-MS data, where <em>ppm</em> parameter values was changed and all other centWave parameters were held constant.</p>
<p align="center">
<img src="../imgs/pars1/ppm_comp.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="mzdiff-accepted-closeness-of-two-signals-in-mz-dimension" class="section level2">
<h2 class="hasAnchor">
<a href="#mzdiff-accepted-closeness-of-two-signals-in-mz-dimension" class="anchor"></a><strong><em><span style="color:red">mzdiff</span></em></strong>: Accepted closeness of two signals in m/z dimension</h2>
<p>The <em>mzdiff</em> parameter specifies the allowed minimum distance of two co-eluting peaks in m/z dimension. An <em>mzdiff</em> value of 1 indicates that the m/z value of two signals with overalapping scan times be at least 1, in order for both signals to be included in the result peak list.</p>
<p>The centWave <em>mzdiff</em> parameter can also take negative values, indicating that the same data point can be allocated to two different peaks. Assigning negative <em>mzdiff</em> values has implications for further downstream processing steps, e.g., establishing correspondence of overlapping peaks across different samples. Higher <em>mzdiff</em> parameter values lead to detecting more features (potential signals), lower values reduce the number of features detected.</p>
<p>Below is an example using the same data processed with <em>mzdiff</em> values of 1 and 0.01.</p>
<p align="center">
<img src="../imgs/pars1/mzdiff.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="noise-intensity-cut-off-values-below-are-not-considered" class="section level2">
<h2 class="hasAnchor">
<a href="#noise-intensity-cut-off-values-below-are-not-considered" class="anchor"></a><strong><em><span style="color:red">noise</span></em></strong>: Intensity cut-off, values below are not considered</h2>
<p>The ion detection in most mass spectrometers is accomplished with electron multipliers. These instruments are highly sensitive and produce electronical noise, which is visible as (usually) random data points below a certain intensity cut-off.</p>
<p>The noise structure of LC-MS spectra generated with mass specs of different types and from different vendors (incl. software updates) can be inherently different. Therefore, this parameter requires careful adjustment for each mass spectrometer setup. Lower values increases <em>centWave</em> computation time, higher values lead to missing out on true data signals.</p>
<p align="center">
<img src="../imgs/pars1/noise.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="snthresh-threshold-of-signal-to-noise-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#snthresh-threshold-of-signal-to-noise-ratio" class="anchor"></a><strong><em><span style="color:red">snthresh</span></em></strong>: Threshold of signal to noise ratio</h2>
<p>Closely related to the noise structure is the <em>snthresh</em> parameter, allowing to set a minimal signal to noise ratio (S/N) for peaks to be detected. <em>snthresh</em> builds on an S/N estimate that defines noise intensities locally in the scan time dimension:</p>
<p align="center">
<img src="../imgs/pars1/snthresh_formula.png"></p>
<p>This S/N definition can be problematic when the noise structure is not evenly distributed across the m/z dimension. The example below shows that higher intensity signals are discarded with higher <em>snthresh</em> values, most likely due to noisy and high intensity data points in proximity to the signal’s m/z trace. The final peak list using a high <em>snthresh</em> parameter value contains signals of low intensities, which is somewhat unexpected.</p>
<p align="center">
<img src="../imgs/pars1/snthresh_comp.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="peakwidth-range-of-peak-elution-times" class="section level2">
<h2 class="hasAnchor">
<a href="#peakwidth-range-of-peak-elution-times" class="anchor"></a><strong><em><span style="color:red">peakwidth</span></em></strong>: Range of peak elution times</h2>
<p>The <em>peakwidth</em> parameter allows specification of the minimal and maximal peak elution time (in seconds). Setting the minimal elution time to higher values risks missing out small signals (usually of low intensity). However, the literature suggest a minimum number of six data points in order to quantify a peak reliably. Therefore, the optimal minimal <em>peakwidth</em> parameter is related to the number of scans on MS 1 level (this is a user-defined setting of the mass spectrometer).</p>
<p>The example below shows the results of <em>centWave</em> peak picking performed with different <em>peakwidth</em> parameter values and where all other parameters were held constant.</p>
<p>An unexpected algorithm behaviour was observed when setting the minimal elution time to a value of 1, which resulted in peak splitting of a coherent signal which was not split with higher <em>peakwidth</em> values.</p>
<p align="center">
<img src="../imgs/pars1/peakwidth.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="prefilter-number-of-data-points-k-exceeding-a-certain-intensity-threshold-i" class="section level2">
<h2 class="hasAnchor">
<a href="#prefilter-number-of-data-points-k-exceeding-a-certain-intensity-threshold-i" class="anchor"></a><strong><em><span style="color:red">prefilter</span></em></strong>: Number of data points (<em>k</em>) exceeding a certain intensity threshold (<em>I</em>)</h2>
<p>The <em>prefilter</em> parameter is similar to the <em>noise</em> parameter, but instead of specifying an intensity cut-off, it specifies a minimal number of data points (<em>k</em>) that exceed a certain intensity value (<em>I</em>). A signal is discarded if it is represented by less than <em>k</em> consecutive data points of intensity <em>I</em>.</p>
<p>Lower <em>prefilter</em> parameter values perform less filtering of signals with low intensity / scan time, and therefore, reduce computation time. The values of this parameter strongly depend on the characteristics of well-behavied LC-MS signals. This parameter should not be set to stringent as it can lead to discarding true positive signals.</p>
<p align="center">
<img src="../imgs/pars1/prefilter.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="mzcenterfun-mz-summary-statistic-of-a-peak" class="section level2">
<h2 class="hasAnchor">
<a href="#mzcenterfun-mz-summary-statistic-of-a-peak" class="anchor"></a><strong><em><span style="color:red">mzCenterFun</span></em></strong>: m/z summary statistic of a peak</h2>
<p>In the final LC-MS feature table, each feature is characterised by a scan time and m/z value. The latter represents a summary statistic of all data points defining a feature, where each one has a slightly different m/z value (see also <em>ppm</em> parameter). The <em>mzCenterFun</em> parameter specifies the m/z summary statistic of a feature. In practice, the different <em>mzCenterFun</em> options have very little impact.</p>
<p align="center">
<img src="../imgs/pars1/mzCenterFun.png"></p>
<p> </p>
<p> </p>
<p> </p>
</div>
<div id="integrate-integration-method-for-peak-quantification" class="section level2">
<h2 class="hasAnchor">
<a href="#integrate-integration-method-for-peak-quantification" class="anchor"></a><strong><em><span style="color:red">integrate</span></em></strong>: Integration method for peak quantification</h2>
<p>Signal quantification is performed by integrating the area under a peak. The <em>integrate</em> function specifies if the non-transformed data should be used for peak integration or if a wavelet-transform filtered data should be used (upper and lower panel, respectively, in the plot below). The former is sensitive to outliers and noise, since <em>centWave</em> defines left and right peak boundaries through change in slope (see Figure below). The latter is less sensitive to noise, however, the wavelet-filtered data is less exact and can lead to signal mis-representations.</p>
<p align="center">
<img src="../imgs/pars1/integrate.png"></p>
<p> </p>
<p> </p>
<p>  ## <strong><em><span style="color:red">fitgauss</span></em></strong>: Peak parametrisation using Gaussian distribution A Gaussian function resembles a characterisitic symmetric “bell curve” shape, which is often described as a normal distribution. If this <em>centWave</em> parameter option is set to TRUE, a Gaussian is fitted to each each feature. The <em>xcms</em> documentation states that when this option is enabled it “affects mostly the retention time position of the peak.”</p>
<p> </p>
<p> </p>
<p>  ## <strong><em><span style="color:red">scanrange</span></em></strong>: Perform peak picking in a specific scan range The <em>scanrange</em> parameter allows to select a scan time interval for peak picking of the entire m/z range. Spectral data outside the specified interval are not considered for peak picking. This parameter is usually not specified in untargeted metabolic profiling studies. The <em>scanrange</em> parameter takes scan ID values (it is not specified in seconds).</p>
<p align="center">
<img src="../imgs/pars1/scanrange.png"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#ppm-allowed-signal-deviation-in-mz-dimension"><strong><em><span style="color:red">ppm</span></em></strong>: Allowed signal deviation in m/z dimension</a></li>
      <li><a href="#mzdiff-accepted-closeness-of-two-signals-in-mz-dimension"><strong><em><span style="color:red">mzdiff</span></em></strong>: Accepted closeness of two signals in m/z dimension</a></li>
      <li><a href="#noise-intensity-cut-off-values-below-are-not-considered"><strong><em><span style="color:red">noise</span></em></strong>: Intensity cut-off, values below are not considered</a></li>
      <li><a href="#snthresh-threshold-of-signal-to-noise-ratio"><strong><em><span style="color:red">snthresh</span></em></strong>: Threshold of signal to noise ratio</a></li>
      <li><a href="#peakwidth-range-of-peak-elution-times"><strong><em><span style="color:red">peakwidth</span></em></strong>: Range of peak elution times</a></li>
      <li><a href="#prefilter-number-of-data-points-k-exceeding-a-certain-intensity-threshold-i"><strong><em><span style="color:red">prefilter</span></em></strong>: Number of data points (<em>k</em>) exceeding a certain intensity threshold (<em>I</em>)</a></li>
      <li><a href="#mzcenterfun-mz-summary-statistic-of-a-peak"><strong><em><span style="color:red">mzCenterFun</span></em></strong>: m/z summary statistic of a peak</a></li>
      <li><a href="#integrate-integration-method-for-peak-quantification"><strong><em><span style="color:red">integrate</span></em></strong>: Integration method for peak quantification</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Torben Kimhofer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
